{%extends "structure.html"%}
{%load static%}

{%block title%}{%block titleMain%}Home{%endblock%}{%endblock%}

{%block static%}
    <link rel='stylesheet' href='{%static "css/index/main.css"%}'>
    <link rel='stylesheet' href='{%static "css/index/new_forms.css"%}'>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css'>
    {%block staticMain%}{%endblock%}
{%endblock%}

{%block content%}
    <section>
        <div class='main'>
            <div class="main-header" style="background-color: {{ headerMainColor }};">
                <div class="main-header-center">
                    <div class="main-header-image">
                        <a href="/">
                            <img id="image-logo" src="/media/logo.png"/>
                        </a>
                    </div>
                    <div class="main-header-amount">
                        <div class="main-header-amount-center">
                            <div class="main-header-amount-box">
                                <div class="container-title-balance">
                                    <span>My balance</span>
                                </div>
                                <div class="container-balance">
                                    <span>
                                        <i class="fa-solid fa-coins"></i>
                                        $
                                    </span>
                                    <span class="my-amount">{{amount}}</span>
                                </div>
                                <!--<div class="container-credits-balance">
                                    <span>avaible</span>
                                </div>-->
                            </div>
                        </div>
                        <div class="btn-menu-container">
                            <div class="btn-menu-container-center">
                                <div class="btn-menu">
                                    <div class="line-btn"></div>
                                    <div class="line-btn"></div>
                                    <div class="line-btn"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="main-body">
                <div class="main-body-center">
                    {%block contentMain%}{%endblock%}
                </div>
            </div>
        </div>

        <div class="menu-suspend-modal">
            <div class="modal-box">
                <div class="buttons">
                    <div class="menu-suspend-options">
                        <ul>
                            {%if auth == True%}
                                <li>
                                    <a href="/panel">Manager</a>
                                </li>
                            {%endif%}
                            <li>
                                <a href="/">Watch Videos</a>
                            </li>
                            <li>
                                <a href="/draw">Draw Money</a>
                            </li>
                            <li>
                                <a href="/logout">Quit</a>
                            </li>
                        </ul>
                    </div>
                   <div class="close-menu"><svg id="Layer_1" style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M443.6,387.1L312.4,255.4l131.5-130c5.4-5.4,5.4-14.2,0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4  L256,197.8L124.9,68.3c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4L68,105.9c-5.4,5.4-5.4,14.2,0,19.6l131.5,130L68.4,387.1  c-2.6,2.6-4.1,6.1-4.1,9.8c0,3.7,1.4,7.2,4.1,9.8l37.4,37.6c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1L256,313.1l130.7,131.1  c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1l37.4-37.6c2.6-2.6,4.1-6.1,4.1-9.8C447.7,393.2,446.2,389.7,443.6,387.1z"/></svg></div>
                </div>
            </div>


        </div>
      </div>

        {%if first != True%}
            <div class="modal-card-menu-first">
                <div class="card-menu-first">
                    <div class="card-menu-first-container">
                        <div class="message-welcome">
                            <h3>{{ welcome_popup }}</h3>
                        </div>
                        <div class="video-apresentation">
                            <div class="video-apresentation-container">
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/{{ welcome_link_video }}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                            </div>
                        </div>
                        <div class="btn-confirm-apresentation-container">
                            <div class="btn-confirm-apresentation">Start</div>
                        </div>
                    </div>
                </div>
            </div>
        {%endif%}

        {%if amount_draw >= min_draw%}
            <div class="modal-card-menu-first" display="none">
                <div class="card-menu-first">
                    <div class="card-menu-first-container">
                        <div class="message-welcome">
                            <h3>Congratulations {{ username }} you can now redeem your balance!</h3>
                        </div>
                        <div class="video-apresentation">
                            <div class="video-apresentation-container">
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/{{ video_reedem }}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                            </div>
                        </div>
                        <div class="btn-confirm-apresentation-container">
                            <a href="{{ url_reedem }}">
                                <div class="btn-confirm-redeem">Redeem</div>
                            </a>
                        </div>
                    </div>
                    <div class="modal-close modal-close-reedem no-select close-menu">
                        <span>X</span>
                    </div>
                </div>
            </div>
        {%endif%}
        
    </section>

    <style>
        .container-title-balance span{
            color: {{ primarycolor }};
        }
        .main-header-amount-center, .line-btn{
            background-color: {{ primarycolor }};
        }

        .menu-suspend-options a:hover{
            color: {{ primarycolor }};
        }
        .container-balance{
        color: {{ text_color_balance }};
    }
    </style>
{%endblock%}

{%block scripts%}
    <script src="{%static 'js/index/mainStructure.js'%}"></script>
    {%block scriptMain%}{%endblock%}
    {%if first != True%}
        <script>
            document.getElementsByClassName('btn-confirm-apresentation')[0].addEventListener('click', function (){
                var xhr = new XMLHttpRequest()
                xhr.open('POST', '/api/first/access', true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.onload = async function() {
                    if (xhr.status === 200) {
                        var response = JSON.parse(xhr.responseText);
                        if(response.status){
                            document.getElementsByClassName('modal-card-menu-first')[0].style.display = 'none';
                        }else{
                            alert(response.message);
                        }
                    }
                }
                xhr.send();
            })
        </script>
    {%endif%}

    {%if amount_draw >= min_draw%}
    <script>
        document.getElementsByClassName('modal-close-reedem')[0].addEventListener('click', function (){
            document.getElementsByClassName('modal-card-menu-first')[0].style.display = 'none';
        })
    </script>
    {%endif%}
{%endblock%}